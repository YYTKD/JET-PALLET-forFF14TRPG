<!DOCTYPE html>
<html lang="ja" data-theme="dracula">

<head>
    <link rel="icon" href="assets/logos/jet_dice.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" />
    <link rel="stylesheet" href="styles/theme-dracula.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>forFF14TTRPG</title>

</head>

<nav>
    <!--バフデバフ表示-->
    <header>
        <div class="buff-area">
            <div class="buff" data-buff-duration="until-turn-end">
                <span class="buff__limit">0t</span>
                <img src="assets/dummy_icon-buff.png" />
                <div class="tooltip  card card--tooltip">
                    <div class="card__header">
                        <div class="card__icon">
                            <img class="card__icon--image" src="assets/dummy_icon-buff.png" />
                        </div>
                        <div class="card__title">
                            <span class="card__name">WSコンボ<span class="card__tags">バフ</span></span>
                        </div>
                    </div>
                    <div class="card__body">
                        <div class="card__stat">
                            <span class="card__label">詳細：</span>
                            <span class="card__value"><i>メイン・物理</i>のアビリティを使用できる状態</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">種別：</span>
                            <span class="card__value">バフ</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">残りターン：</span>
                            <span class="card__value">0t</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">コマンド：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">追加テキスト：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">対象：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="buff" data-buff-duration="until-next-turn-start">
                <span class="buff__limit">1t</span>
                <img src="assets/dummy_icon-buff.png" />
                <div class="tooltip  card card--tooltip">
                    <div class="card__header">
                        <div class="card__icon">
                            <img class="card__icon--image" src="assets/dummy_icon-buff.png" />
                        </div>
                        <div class="card__title">
                            <span class="card__name">オーバーパワー<span class="card__tags">バフ</span></span>
                        </div>
                    </div>
                    <div class="card__body">
                        <div class="card__stat">
                            <span class="card__label">詳細：</span>
                            <span class="card__value"><i>メイン</i>のアビリティで与えるダメージに+2点</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">種別：</span>
                            <span class="card__value">バフ</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">残りターン：</span>
                            <span class="card__value">1t</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">コマンド：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">追加テキスト：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">対象：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="buff" data-buff-duration="permanent">
                <span class="buff__limit">永続</span>
                <img src="assets/dummy_icon-buff.png" />
                <div class="tooltip  card card--tooltip">
                    <div class="card__header">
                        <div class="card__icon">
                            <img class="card__icon--image" src="assets/dummy_icon-buff.png" />
                        </div>
                        <div class="card__title">
                            <span class="card__name">WSコンボ<span class="card__tags">バフ</span></span>
                        </div>
                    </div>
                    <div class="card__body">
                        <div class="card__stat">
                            <span class="card__label">詳細：</span>
                            <span class="card__value"><i>メイン・物理</i>のアビリティを使用できる状態</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">種別：</span>
                            <span class="card__value">バフ</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">残りターン：</span>
                            <span class="card__value">永続</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">コマンド：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">追加テキスト：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                        <div class="card__stat">
                            <span class="card__label">対象：</span>
                            <span class="card__value is-placeholder">未設定</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section__header--buttons">
            <button class="material-symbols-rounded">settings</button>
            <button class="material-symbols-rounded" command="show-modal" commandfor="addBuffModal">add</button>
        </div>
        </div>
    </header>
    <footer>
        <button class="character__banner" command="show-modal" commandfor="characterSettingModal">
            <span class="character__job">モンク</span>
            <span class="character__level">Lv50</span>
        </button>
        <div class="button__area--footer">
            <button class="button__footer button__footer--turn material-symbols-rounded" data-turn-action="start">hourglass_top<h6>ターン開始</h6></button>
            <button class="button__footer button__footer--turn material-symbols-rounded" data-turn-action="end">hourglass_empty<h6>ターン終了</h6></button>
            <button class="button__footer button__footer--turn material-symbols-rounded">refresh<h6>ラウンド終了</h6></button>
            <button class="button__footer button__footer--turn material-symbols-rounded" data-turn-action="phase">calendar_clock<h6>フェイズ更新</h6></button>
        </div>
    </footer>
</nav>

<main>
    <div class="ability-block">
        <!--その他アクション-->
        <section>
            <div class="section__header section__header--OTHER">
                <span class="section__header--title">
                    <h3>OTHER ACTION</h3>
                    <h6>特殊アクション</h6>
                </span>
                <div class="section__header--buttons">
                    <button class="material-symbols-rounded">settings</button>
                    <button class="material-symbols-rounded" command="show-modal"
                        commandfor="addAbilityModal" data-target-area="other">add</button>
                </div>
            </div>
            <div class="section__body">
                <div class="ability-area" data-ability-area="other">
                    <div class="ability" draggable="true">
                        <svg viewBox="0 0 52 52" class="ability__proc-line" style="display: none;">
                            <!-- 正方形を沿う経路（上→右→下→左） -->
                            <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                        </svg>
                        <img src="assets/dummy_icon.png" />
                        <div class="tooltip  card card--tooltip">
                            <div class="card__header">
                                <div class="card__icon">
                                    <img class="card__icon--image" src="assets/dummy_icon.png" />
                                </div>
                                <div class="card__title">
                                    <span class="card__name">リミットブレイク：サジタリウスアロー<span
                                            class="card__tags">物理・リミットブレイク</span></span>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">タイミング：</span>
                                        <span class="card__value">いつでも</span>
                                    </div>
                                </div>
                                <div class="card__meta">

                                    <div class="card__stat">
                                        <span class="card__label">対象：</span>
                                        <span class="card__value">範囲内のすべての敵</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">範囲：</span>
                                        <span class="card__value">君に隣接する５マス幅の直線</span>
                                    </div>
                                </div>
                            </div>
                            <div class="card__body">
                                <div class="card__stat">
                                    <span class="card__label">基本効果：</span>
                                    <span
                                        class="card__value">対象に6d6点の頭割りダメージ（範囲内の敵の人数で6d6点を均等に割り振る（切り上げ））と、DOT4を与える。</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--メインアクション-->
        <section>
            <div class="section__header section__header--MAIN">
                <span class="section__header--title">
                    <h3>MAIN ACTION</h3>
                    <h6>メインアクション</h6>
                </span>
                <div class="section__header--buttons">
                    <button class="material-symbols-rounded">settings</button>
                    <button class="material-symbols-rounded" command="show-modal"
                        commandfor="addAbilityModal" data-target-area="main">add</button>
                </div>
            </div>
            <div class="section__body">
                <div class="ability-area" data-ability-area="main">
                    <div class="ability" draggable="true">
                        <svg viewBox="0 0 52 52" class="ability__proc-line">
                            <!-- 正方形を沿う経路（上→右→下→左） -->
                            <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                        </svg>
                        <img src="assets/dummy_icon.png" />
                        <div class="tooltip  card card--tooltip">
                            <div class="card__header">
                                <div class="card__icon">
                                    <img class="card__icon--image" src="assets/dummy_icon.png" />
                                </div>
                                <div class="card__title">
                                    <span class="card__name">WSコンボWSコンボWSコンボ<span
                                            class="card__tags">物理・メイン</span></span>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">前提：</span>
                                        <span
                                            class="card__value">敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                                    </div>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">タイミング：</span>
                                        <span class="card__value"></span>
                                    </div>
                                </div>
                                <div class="card__meta">
                                    <div class="card__stat">
                                        <span class="card__label">コスト：</span>
                                        <span class="card__value"></span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">対象：</span>
                                        <span class="card__value">範囲内のすべての敵</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">範囲：</span>
                                        <span class="card__value">君を中心とした３×３マス</span>
                                    </div>
                                </div>
                                <div class="card__stat--judge">
                                    <span class="card__label">判定：</span>
                                    <span class="card__value">【STR】+d20<span class="bold">　VS　</span>物理</span>
                                </div>
                            </div>
                            <div class="card__body">
                                <div class="card__stat">
                                    <span class="card__label">基本効果：</span>
                                    <span class="card__value">対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">ダイレクトヒット：</span>
                                    <span class="card__value">+1d6点の追加ダメージ。</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">制限：</span>
                                    <span class="card__value">１フェーズに３回使用可能。</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ability" draggable="true">
                        <svg viewBox="0 0 52 52" class="ability__proc-line" style="display: none;">
                            <!-- 正方形を沿う経路（上→右→下→左） -->
                            <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                        </svg>
                        <img src="assets/dummy_icon.png" />
                        <div class="tooltip  card card--tooltip">
                            <div class="card__header">
                                <div class="card__icon">
                                    <img class="card__icon--image" src="assets/dummy_icon.png" />
                                </div>
                                <div class="card__title">
                                    <span class="card__name">WSコンボWSコンボWSコンボ<span
                                            class="card__tags">物理・メイン</span></span>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">前提：</span>
                                        <span
                                            class="card__value">敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                                    </div>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">タイミング：</span>
                                        <span class="card__value"></span>
                                    </div>
                                </div>
                                <div class="card__meta">
                                    <div class="card__stat">
                                        <span class="card__label">コスト：</span>
                                        <span class="card__value"></span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">対象：</span>
                                        <span class="card__value">範囲内のすべての敵</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">範囲：</span>
                                        <span class="card__value">君を中心とした３×３マス</span>
                                    </div>
                                </div>
                                <div class="card__stat--judge">
                                    <span class="card__label">判定：</span>
                                    <span class="card__value">【STR】+d20<span class="bold">　VS　</span>物理</span>
                                </div>
                            </div>
                            <div class="card__body">
                                <div class="card__stat">
                                    <span class="card__label">基本効果：</span>
                                    <span class="card__value">対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">ダイレクトヒット：</span>
                                    <span class="card__value">+1d6点の追加ダメージ。</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">制限：</span>
                                    <span class="card__value">１フェーズに３回使用可能。</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="ability-area--other">
                    <h5 class="other-action-title">必殺技</h5>
                    <div class="ability-area" data-ability-area="main-special">
                        <div class="ability" draggable="true">
                            <svg viewBox="0 0 52 52" class="ability__proc-line" style="display: none;">
                                <!-- 正方形を沿う経路（上→右→下→左） -->
                                <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                            </svg>
                            <img src="assets/dummy_icon.png" />
                            <div class="tooltip  card card--tooltip">
                                <div class="card__header">
                                    <div class="card__icon">
                                        <img class="card__icon--image" src="assets/dummy_icon.png" />
                                    </div>
                                    <div class="card__title">
                                        <span class="card__name">WSコンボWSコンボWSコンボ<span
                                                class="card__tags">物理・メイン</span></span>
                                    </div>
                                    <div class="card__trigger">
                                        <div class="card__stat">
                                            <span class="card__label">前提：</span>
                                            <span
                                                class="card__value">敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                                        </div>
                                    </div>
                                    <div class="card__trigger">
                                        <div class="card__stat">
                                            <span class="card__label">タイミング：</span>
                                            <span class="card__value"></span>
                                        </div>
                                    </div>
                                    <div class="card__meta">
                                        <div class="card__stat">
                                            <span class="card__label">コスト：</span>
                                            <span class="card__value"></span>
                                        </div>
                                        <div class="card__stat">
                                            <span class="card__label">対象：</span>
                                            <span class="card__value">範囲内のすべての敵</span>
                                        </div>
                                        <div class="card__stat">
                                            <span class="card__label">範囲：</span>
                                            <span class="card__value">君を中心とした３×３マス</span>
                                        </div>
                                    </div>
                                    <div class="card__stat--judge">
                                        <span class="card__label">判定：</span>
                                        <span class="card__value">【STR】+d20<span class="bold">　VS　</span>物理</span>
                                    </div>
                                </div>
                                <div class="card__body">
                                    <div class="card__stat">
                                        <span class="card__label">基本効果：</span>
                                        <span class="card__value">対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">ダイレクトヒット：</span>
                                        <span class="card__value">+1d6点の追加ダメージ。</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">制限：</span>
                                        <span class="card__value">１フェーズに３回使用可能。</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--サブアクション-->
        <section>
            <div class="section__header section__header--SUB">
                <span class="section__header--title">
                    <h3>SUB ACTION</h3>
                    <h6>サブアクション</h6>
                </span>
                <div class="section__header--buttons">
                    <button class="material-symbols-rounded">settings</button>
                    <button class="material-symbols-rounded" command="show-modal"
                        commandfor="addAbilityModal" data-target-area="sub">add</button>
                </div>
            </div>
            <div class="section__body">
                <div class="ability-area" data-ability-area="sub">
                    <div class="ability" draggable="true">
                        <svg viewBox="0 0 52 52" class="ability__proc-line">
                            <!-- 正方形を沿う経路（上→右→下→左） -->
                            <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                        </svg>
                        <img src="assets/dummy_icon.png" />
                        <div class="tooltip  card card--tooltip">
                            <div class="card__header">
                                <div class="card__icon">
                                    <img class="card__icon--image" src="assets/dummy_icon.png" />
                                </div>
                                <div class="card__title">
                                    <span class="card__name">WSコンボWSコンボWSコンボ<span
                                            class="card__tags">物理・メイン</span></span>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">前提：</span>
                                        <span
                                            class="card__value">敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                                    </div>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">タイミング：</span>
                                        <span class="card__value"></span>
                                    </div>
                                </div>
                                <div class="card__meta">
                                    <div class="card__stat">
                                        <span class="card__label">コスト：</span>
                                        <span class="card__value"></span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">対象：</span>
                                        <span class="card__value">範囲内のすべての敵</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">範囲：</span>
                                        <span class="card__value">君を中心とした３×３マス</span>
                                    </div>
                                </div>
                                <div class="card__stat--judge">
                                    <span class="card__label">判定：</span>
                                    <span class="card__value">【STR】+d20<span class="bold">　VS　</span>物理</span>
                                </div>
                            </div>
                            <div class="card__body">
                                <div class="card__stat">
                                    <span class="card__label">基本効果：</span>
                                    <span class="card__value">対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">ダイレクトヒット：</span>
                                    <span class="card__value">+1d6点の追加ダメージ。</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">制限：</span>
                                    <span class="card__value">１フェーズに３回使用可能。</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--インスタントアクション-->
        <section>
            <div class="section__header section__header--INSTANT">
                <span class="section__header--title">
                    <h3>INSTANT ACTION</h3>
                    <h6>インスタントアクション</h6>
                </span>
                <div class="section__header--buttons">
                    <button class="material-symbols-rounded" onclick="modal">settings</button>
                    <button class="material-symbols-rounded" command="show-modal"
                        commandfor="addAbilityModal" data-target-area="instant">add</button>
                </div>
            </div>
            <div class="section__body">
                <div class="ability-area" data-ability-area="instant">
                    <div class="ability" draggable="true">
                        <svg viewBox="0 0 52 52" class="ability__proc-line">
                            <!-- 正方形を沿う経路（上→右→下→左） -->
                            <path class="dashed-path" d="M 3 3 L 49 3 L 49 49 L 3 49 L 3 3" />
                        </svg>
                        <img src="assets/dummy_icon.png" />
                        <div class="tooltip  card card--tooltip">
                            <div class="card__header">
                                <div class="card__icon">
                                    <img class="card__icon--image" src="assets/dummy_icon.png" />
                                </div>
                                <div class="card__title">
                                    <span class="card__name">WSコンボWSコンボWSコンボ<span
                                            class="card__tags">物理・メイン</span></span>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">前提：</span>
                                        <span
                                            class="card__value">敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                                    </div>
                                </div>
                                <div class="card__trigger">
                                    <div class="card__stat">
                                        <span class="card__label">タイミング：</span>
                                        <span class="card__value"></span>
                                    </div>
                                </div>
                                <div class="card__meta">
                                    <div class="card__stat">
                                        <span class="card__label">コスト：</span>
                                        <span class="card__value"></span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">対象：</span>
                                        <span class="card__value">範囲内のすべての敵</span>
                                    </div>
                                    <div class="card__stat">
                                        <span class="card__label">範囲：</span>
                                        <span class="card__value">君を中心とした３×３マス</span>
                                    </div>
                                </div>
                                <div class="card__stat--judge">
                                    <span class="card__label">判定：</span>
                                    <span class="card__value">【STR】+d20<span class="bold">　VS　</span>物理</span>
                                </div>
                            </div>
                            <div class="card__body">
                                <div class="card__stat">
                                    <span class="card__label">基本効果：</span>
                                    <span class="card__value">対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">ダイレクトヒット：</span>
                                    <span class="card__value">+1d6点の追加ダメージ。</span>
                                </div>
                                <div class="card__stat">
                                    <span class="card__label">制限：</span>
                                    <span class="card__value">１フェーズに３回使用可能。</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--コマンド生成-->
        <section>
            <div class="section__header section__header--COMMAND">
                <span class="section__header--title">
                    <h3>COMMAND</h3>
                    <h6>コマンド</h6>
                </span>
            </div>
            <div class="section__body section__body--command">
                <h4>判定</h4>
                <div class="output">
                    <div class="output__label">コピペ用コマンド</div>
                    <div class="output__text" id="judgeOutput">判定を選択してください</div>
                    <button class="button button--copy" data-target="judgeOutput">コピー</button>
                </div>
                <h4>ダメージ</h4>
                <div class="command-option-area">
                    <label class="command-option command-option__DH">
                        <input type="checkbox"><span class="material-symbols-rounded">check_box</span>
                        <h5>ダイレクトヒット</h5>
                    </label>
                    <label class="command-option command-option__CR">
                        <input type="checkbox"><span class="material-symbols-rounded">check_box</span>
                        <h5>クリティカル</h5>
                    </label>
                </div>
                <div class="output">
                    <div class="output__label">コピペ用コマンド</div>
                    <div class="output__text" id="attackOutput">ダメージを選択してください</div>
                    <button class="button button--copy" data-target="attackOutput">コピー</button>
                </div>
            </div>
        </section>
    </div>
    <div class="trait-block">
        <!--特性・リソース-->
        <div class="section--TRAIT">
            <div class="section__header section__header--TRAIT">
                <span class="section__header--title">
                    <h3>TRAIT</h3>
                    <h6>特性</h6>
                </span>
                <div class="section__header--buttons">
                    <button class="material-symbols-rounded" command="show-modal"
                        commandfor="addTRAITModal">add</button>
                </div>
            </div>
            <div class="section__body section__body--TRAIT">
                <div class="trait-area">
                    <div class="resource__group" title="MP">
                        <span class="resource__label">MP</span>
                        <div class="resource--gauge">
                            <img class="resource__icon--gauge" src="assets/resource--gauge.png" />
                            <span class="resource__icon--gauge-value">2</span>
                        </div>
                    </div>
                    <div class="resource__group" title="闘気">
                        <span class="resource__label">リソース名</span>
                        <div class="resource--stack resource__icon">
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        </div>
                        <div class="resource__control">
                            <button class="resource__btn">-</button>
                            <button class="resource__btn">+</button>
                        </div>
                    </div>
                    <div class="resource__group" title="波動">
                        <span class="resource__label">リソース名</span>
                        <div class="resource--gauge resource__icon">
                            <img class="resource__icon--gauge" src="assets/resource--gauge.png" />
                            <span class="resource__icon--gauge-value">2</span>
                        </div>
                        <div class="resource__control">
                            <button class="resource__btn">-</button>
                            <button class="resource__btn">+</button>
                        </div>
                    </div>
                    <div class="resource__group" title="壱の型">
                        <span class="resource__label">🤔</span>
                        <div class="resource--stack resource__icon">
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        </div>
                        <div class="resource__control">
                            <button class="resource__btn">-</button>
                            <button class="resource__btn">+</button>
                        </div>
                    </div>
                    <div class="resource__group" title="弐の型">
                        <span class="resource__label">弐</span>
                        <div class="resource--stack resource__icon">
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        </div>
                        <div class="resource__control">
                            <button class="resource__btn">-</button>
                            <button class="resource__btn">+</button>
                        </div>
                    </div>
                    <div class="resource__group" title="参の型">
                        <span class="resource__label">参</span>
                        <div class="resource--stack resource__icon">
                            <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        </div>
                        <div class="resource__control">
                            <button class="resource__btn">-</button>
                            <button class="resource__btn">+</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <!--モーダル_アビリティ登録-->
    <dialog class="dialog--AB" id="addAbilityModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">アビリティ登録</div>
                <button class="material-symbols-rounded" command="close" commandfor="addAbilityModal">close</button>
            </div>
            <div class="dialog__body">
                <div class="form__options">
                    <label class="form__option--button">
                        <input type="checkbox" data-ability-preview-toggle>
                        <h4>プレビューを表示</h4>
                    </label>
                </div>
                <h3>基本情報</h3>
                <div class="form__row">
                    <!--アイコン-->
                    <div class="form__group">
                        <span class="form__label">アイコン</span>
                        <div class="form__row">
                            <img id="iconpreview" class="card__icon--image" src="assets/dummy_icon.png" />
                            <div class="form__row">
                                <select class="form__option--type" data-ability-icon-select>
                                    <option value="">アイコンを選択</option>
                                </select>
                                <label class="form__option--button">
                                    <input type="file" class="form__input--icon" data-ability-icon-input>
                                    <h4>ファイルを選択</h4>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form__group">
                        <span class="form__label">種別</span>
                        <select class="form__option--type" data-ability-type>
                            <option class="dammy" value="main">メイン</option>
                            <option class="dammy" value="sub">サブ</option>
                            <option class="dammy" value="instant">インスタント</option>
                            <option class="dammy" value="other">特殊</option>
                        </select>
                    </div>
                </div>
                <div class="form__row">
                    <!--名前-->
                    <div class="form__group">
                        <span class="form__label">アビリティ名</span>
                        <input type="text" class="form__input--normal" data-ability-name>
                    </div>
                    <!--スタック数-->
                    <div class="form__group">
                        <span class="form__label">スタック数</span>
                        <input type="number" class="form__input--normal" data-ability-stack>
                    </div>
                </div>
                <!--タグ-->
                <div class="form__group">
                    <span class="form__label">タグ</span>
                    <div class="form__row">
                        <span class="tag">物理<span type="button">x</span></span>
                        <span class="tag">メイン<span type="button">x</span></span>
                        <span class="tag">連射<span type="button">x</span></span>
                    </div>
                    <div class="form__row">
                        <input type="text" class="form__input--normal" placeholder="タグを入力してEnter"
                            data-ability-tag-input>
                        <button class="form__button" data-ability-tag-add>追加</button>
                    </div>
                </div>
                <h3>選択情報</h3>
                <div class="form__row">
                    <!--前提-->
                    <div class="form__group">
                        <span class="form__label">前提</span>
                        <input type="text" class="form__input--normal" data-ability-prerequisite>
                    </div>
                    <!--タイミング-->
                    <div class="form__group">
                        <span class="form__label">タイミング</span>
                        <input type="text" class="form__input--normal" data-ability-timing>
                    </div>
                </div>
                <div class="form__row">
                    <!--コスト-->
                    <div class="form__group">
                        <span class="form__label">コスト</span>
                        <input type="text" class="form__input--normal" data-ability-cost>
                    </div>
                    <!--制限-->
                    <div class="form__group">
                        <span class="form__label">制限</span>
                        <input type="text" class="form__input--normal" data-ability-limit>
                    </div>
                </div>
                <div class="form__row">
                    <!--対象-->
                    <div class="form__group">
                        <span class="form__label">対象</span>
                        <input type="text" class="form__input--normal" data-ability-target>
                    </div>
                    <!--範囲-->
                    <div class="form__group">
                        <span class="form__label">範囲</span>
                        <input type="text" class="form__input--normal" data-ability-range>
                    </div>
                </div>
                <h3>判定・ダメージ</h3>
                <div class="form__row">
                    <!--判定-->
                    <div class="form__group">
                        <span class="form__label">判定</span>
                        <div class="form__row">
                            <input type="text" class="form__input--normal" data-ability-judge>
                            <select data-ability-judge-attribute>
                                <option>+{STR}</option>
                                <option>なし</option>
                            </select>
                        </div>
                    </div>

                </div>
                <div class="form__row">
                    <!--基本ダメージ-->
                    <div class="form__group">
                        <span class="form__label">基本ダメージ</span>
                        <input type="text" class="form__input--normal" data-ability-base-damage>
                    </div>
                    <!--ダイレクトヒット-->
                    <div class="form__group">
                        <span class="form__label">ダイレクトヒット</span>
                        <input type="text" class="form__input--normal" data-ability-direct-hit>
                    </div>
                </div>
                <h3>基本効果</h3>
                <!--基本効果-->
                <div class="form__group">
                    <span class="form__label">効果の説明</span>
                    <textarea class="form__input--description" data-ability-description></textarea>
                </div>
            </div>
            <div class="dialog__footer">
                <button class="dialog__footer__button form__button--add">登録</button>
                <button class="dialog__footer__button form__button--macro" command="show-modal"
                    commandfor="abilityMacroModal">マクロを設定</button>
            </div>
        </div>
        <!--プレビュー-->
        <div class="dialog__preview card card__preview--AB">
            <div class="card__header">
                <div class="card__icon">
                    <img class="card__icon--image" src="assets/dummy_icon.png" data-ability-preview-icon />
                </div>
                <div class="card__title">
                    <span class="card__name" data-ability-preview-name>シールドブロック<span class="card__tags"
                            data-ability-preview-tags>物理・メイン</span></span>
                </div>
                <div class="card__trigger">
                    <div class="card__stat">
                        <span class="card__label">前提：</span>
                        <span class="card__value"
                            data-ability-preview-prerequisite>敵が詠唱のアビリティを使用したか、詠唱のアビリティによる予兆を発生させている敵から1マス以内に君がいる</span>
                    </div>
                </div>
                <div class="card__trigger">
                    <div class="card__stat">
                        <span class="card__label">タイミング：</span>
                        <span class="card__value" data-ability-preview-timing></span>
                    </div>
                </div>
                <div class="card__meta">
                    <div class="card__stat">
                        <span class="card__label">コスト：</span>
                        <span class="card__value" data-ability-preview-cost></span>
                    </div>
                    <div class="card__stat">
                        <span class="card__label">対象：</span>
                        <span class="card__value" data-ability-preview-target>範囲内のすべての敵</span>
                    </div>
                    <div class="card__stat">
                        <span class="card__label">範囲：</span>
                        <span class="card__value" data-ability-preview-range>君を中心とした３×３マス</span>
                    </div>
                </div>
                <div class="card__stat--judge">
                    <span class="card__label">判定：</span>
                    <span class="card__value"
                        data-ability-preview-judge>【STR】+d20<span class="bold">　VS　</span>物理</span>
                </div>
            </div>
            <div class="card__body">
                <div class="card__stat">
                    <span class="card__label">基本効果：</span>
                    <span class="card__value"
                        data-ability-preview-effect>対象に２点のダメージと、君への敵視を与える。コンボ：《シュトルムヴィント》</span>
                </div>
                <div class="card__stat">
                    <span class="card__label">ダイレクトヒット：</span>
                    <span class="card__value" data-ability-preview-direct-hit>+1d6点の追加ダメージ。</span>
                </div>
                <div class="card__stat">
                    <span class="card__label">制限：</span>
                    <span class="card__value" data-ability-preview-limit>１フェーズに３回使用可能。</span>
                </div>
            </div>
        </div>

    </dialog>
    <!--モーダル_アビリティマクロ登録-->
    <dialog class="dialog--MACRO" id="abilityMacroModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">アビリティマクロ設定</div>
                <button class="material-symbols-rounded" command="close" commandfor="abilityMacroModal">close</button>
            </div>
            <div class="dialog__body">
                <h4>編集中アビリティ</h4>

                <!--編集中アビリティ-->
                <div class="form__row">
                    <img id="iconpreview" class="card__icon--image" src="assets/dummy_icon.png" />
                    <h2>崩拳</h2>
                </div>

                <!--前提条件設定-->
                <h3>前提条件設定</h3>
                <div class="form__group">
                    <div class="block-builder">
                        <div class="block-list">
                            <!-- 条件ブロック1: (A AND B) -->
                            <details class="block block--condition">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">条件グループ 1</span>
                                    <span class="block__overview">([参の型]>=[1] または[零の型]>=[1])</span>
                                    <div class="block__controls">
                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <!-- 条件A -->
                                    <div class="block-item">
                                        <div class="block__row">

                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>

                                        </div>
                                        <div class="block__row">
                                            <span class="block__text">状態：</span>
                                            <select class="block__select" style="max-width: 80px;">
                                                <option>=&lt;</option>
                                                <option>=</option>
                                                <option>&gt;=</option>

                                            </select>
                                            <input type="number" class="block__input" value="1"
                                                style="max-width: 60px;">
                                            <button class="block__btn block__btn--danger">削除</button>
                                        </div>

                                    </div>

                                    <!-- AND接続詞 -->
                                    <div class="condition-connector">
                                        <div class="connector-line"></div>
                                        <select class="connector-select">
                                            <option value="and">かつ (AND)</option>
                                            <option value="or">または (OR)</option>
                                        </select>
                                        <div class="connector-line"></div>
                                    </div>

                                    <!-- 条件B -->
                                    <div class="block-item">
                                        <div class="block__row">

                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                        <div class="block__row">
                                            <span class="block__text">状態：</span>
                                            <select class="block__select" style="max-width: 80px;">
                                                <option>=&lt;</option>
                                                <option>=</option>
                                                <option>&gt;=</option>
                                            </select>
                                            <input type="number" class="block__input" value="1"
                                                style="max-width: 60px;">
                                            <button class="block__btn block__btn--danger">削除</button>
                                        </div>
                                    </div>

                                    <!-- グループ内条件追加ボタン -->
                                    <button class="add-condition-btn add-condition-btn--single">＋ 条件を追加</button>
                                </div>
                            </details>
                            <!-- グループ間の論理演算子 -->
                            <div class="group-connector">
                                <div class="connector-line"></div>
                                <select class="connector-select connector-select--group">
                                    <option value="or">または (OR)</option>
                                    <option value="and">かつ (AND)</option>
                                </select>
                                <div class="connector-line"></div>
                            </div>

                            <!-- 条件ブロック2: C -->
                            <details class="block block--condition">
                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">条件グループ 2</span>
                                    <span class="block__overview">[WSコンボ]>=[1]</span>
                                    <div class="block__controls">
                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <!-- 条件C -->
                                    <div class="block-item">
                                        <div class="block__row">

                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                        <div class="block__row">
                                            <span class="block__text">状態：</span>
                                            <select class="block__select" style="max-width: 80px;">
                                                <option>=&lt;</option>
                                                <option>=</option>
                                                <option>&gt;=</option>
                                            </select>
                                            <input type="number" class="block__input" value="1"
                                                style="max-width: 60px;">
                                            <button class="block__btn block__btn--danger">削除</button>
                                        </div>
                                    </div>
                                    <!-- グループ内条件追加ボタン -->
                                    <button class="add-condition-btn add-condition-btn--single">＋ 条件を追加</button>
                                </div>

                            </details>

                        </div>

                    </div>

                    <!-- ブロック追加ボタン -->
                    <div class="add-block-area">
                        <button class="add-block-btn add-block-btn--condition">
                            <span>➕</span>
                            <span>条件グループを追加</span>
                        </button>
                    </div>
                </div>

                <!--アクション設定-->
                <h3>アクション設定</h3>
                <div class="form__group">

                    <div class="block-builder">
                        <div class="block-list">

                            <!-- 通常のアクションブロック例 -->
                            <details class="block block--action">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">アクション</span>
                                    <span class="block__overview">[参の型]-[1]</span>
                                    <div class="block__controls">

                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <div class="block__row">
                                        <select class="block__select">
                                            <option>増やす</option>
                                            <option>減らす</option>
                                            <option>判定・ダメージを追加</option>
                                            <option>判定・ダメージを変更</option>
                                            <option>効果テキストを追加</option>
                                            <option>選択肢を表示</option>
                                        </select>
                                    </div>
                                    <div class="block-item">
                                        <div class="block__row">
                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                            <input type="number" class="block__input" value="+1"
                                                style="max-width: 60px;">
                                        </div>
                                    </div>
                                </div>
                            </details>
                            <!-- 通常のアクションブロック例 -->
                            <details class="block block--action">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">アクション</span>
                                    <span class="block__overview">[零の型]-[1]</span>
                                    <div class="block__controls">

                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <div class="block__row">
                                        <select class="block__select">
                                            <option>増やす</option>
                                            <option>減らす</option>
                                            <option>判定・判定・ダメージを追加</option>
                                            <option>判定・ダメージを変更</option>
                                            <option>効果テキストを追加</option>
                                            <option>選択肢を表示</option>
                                        </select>
                                    </div>
                                    <div class="block-item">
                                        <div class="block__row">
                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                            <input type="number" class="block__input" value="+1"
                                                style="max-width: 60px;">
                                        </div>
                                    </div>
                                </div>
                            </details>
                            <!-- 通常のアクションブロック例 -->
                            <details class="block block--action">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">アクション</span>
                                    <span class="block__overview">[WSコンボ]-[1]</span>
                                    <div class="block__controls">

                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <div class="block__row">
                                        <select class="block__select">
                                            <option>増やす</option>
                                            <option>減らす</option>
                                            <option>判定・ダメージを追加</option>
                                            <option>判定・判定・ダメージを変更</option>
                                            <option>効果テキストを追加</option>
                                            <option>選択肢を表示</option>
                                        </select>
                                    </div>
                                    <div class="block-item">
                                        <div class="block__row">
                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                            <input type="number" class="block__input" value="+1"
                                                style="max-width: 60px;">
                                        </div>
                                    </div>
                                </div>
                            </details>

                            <!-- 条件ブロック2: A -->
                            <details class="block block--condition">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">条件グループ 2</span>
                                    <span class="block__overview">[参の功力]>=[1]</span>
                                    <div class="block__controls">
                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <!-- 条件A -->
                                    <div class="block-item">
                                        <div class="block__row">

                                            <span class="block__text">対象：</span>
                                            <select class="block__select">
                                                <optgroup label="バフ">
                                                    <option>すべてのバフ</option>
                                                    <option>参の型</option>
                                                    <option>参の功力</option>
                                                    <option>WSコンボ</option>
                                                    <option>零の型</option>
                                                </optgroup>
                                                <optgroup label="リソース">
                                                    <option>すべてのリソース</option>
                                                    <option>MP</option>
                                                    <option>闘気</option>
                                                </optgroup>
                                                <optgroup label="アビリティ">
                                                    <option>ブラッドレッター</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                        <div class="block__row">
                                            <span class="block__text">状態：</span>
                                            <select class="block__select" style="max-width: 80px;">
                                                <option>=&lt;</option>
                                                <option>=</option>
                                                <option>&gt;=</option>
                                            </select>
                                            <input type="number" class="block__input" value="1"
                                                style="max-width: 60px;">
                                            <button class="block__btn block__btn--danger">削除</button>
                                        </div>
                                    </div>
                                    <!-- グループ内条件追加ボタン -->
                                    <button class="add-condition-btn add-condition-btn--single">＋ 条件を追加</button>
                                </div>

                            </details>
                            <!-- 成立時アクション接続 -->
                            <div class="action-connector">
                                <div class="connector-line-vertical"></div>
                                <div class="action-connector-label">↓ 条件成立時</div>
                                <div class="connector-line-vertical"></div>
                            </div>

                            <!-- ネストされたアクションブロック -->
                            <details class="block block--action block--nested">

                                <summary class="block__header">
                                    <span class="block__drag-handle">⋮⋮</span>
                                    <span class="block__type">アクション</span>
                                    <span class="block__overview">選択肢を表示</span>
                                    <div class="block__controls">

                                        <button class="block__btn block__btn--danger">削除</button>
                                    </div>
                                </summary>
                                <div class="block__content">
                                    <div class="block__row">
                                        <select class="block__select">
                                            <option>増やす</option>
                                            <option>減らす</option>
                                            <option>判定・ダメージを追加</option>
                                            <option>判定・ダメージを変更</option>
                                            <option>効果テキストを追加</option>
                                            <option>選択肢を表示</option>
                                        </select>
                                    </div>
                                    <div class="block-item">
                                        <div class="block__row">
                                            <span class="block__text">質問：</span>
                                            <input class="block__textbox">
                                            <button class="block__btn" title="選択肢を追加">＋</button>
                                        </div>
                                    </div>


                                    <div class="block__option">
                                        <div class="block__row">
                                            <span class="block__text">選択肢1：</span>
                                            <input class="block__textbox">
                                            <button class="block__btn" title="アクションを追加">＋</button>
                                        </div>
                                        <div class="block__selected-action">
                                            <div class="block__header">
                                                <span class="block__type">アクション</span>
                                                <div class="block__controls">

                                                    <button class="block__btn block__btn--danger">削除</button>
                                                </div>
                                            </div>
                                            <div class="block__content">
                                                <div class="block__row">
                                                    <select class="block__select">
                                                        <option>増やす</option>
                                                        <option>減らす</option>
                                                        <option>判定・ダメージを追加</option>
                                                        <option>判定・ダメージを変更</option>
                                                        <option>効果テキストを追加</option>
                                                        <option>選択肢を表示</option>
                                                    </select>
                                                </div>
                                                <div class="block-item">
                                                    <div class="block__row">
                                                        <span class="block__text">対象：</span>
                                                        <select class="block__select">
                                                            <optgroup label="バフ">
                                                                <option>すべてのバフ</option>
                                                                <option>参の型</option>
                                                                <option>参の功力</option>
                                                                <option>WSコンボ</option>
                                                                <option>零の型</option>
                                                            </optgroup>
                                                            <optgroup label="リソース">
                                                                <option>すべてのリソース</option>
                                                                <option>MP</option>
                                                                <option>闘気</option>
                                                            </optgroup>
                                                            <optgroup label="アビリティ">
                                                                <option>ブラッドレッター</option>
                                                            </optgroup>
                                                        </select>
                                                        <input type="number" class="block__input" value="+1"
                                                            style="max-width: 60px;">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="block__option">
                                        <div class="block__row">
                                            <span class="block__text">選択肢2：</span>
                                            <input class="block__textbox">
                                            <button class="block__btn" title="アクションを追加">＋</button>
                                        </div>
                                    </div>

                                </div>
                                <!-- グループ内条件追加ボタン -->
                                <button class="add-condition-btn add-condition-btn--single">＋ アクションを追加</button>
                            </details>
                        </div>

                    </div>
                    <!-- ブロック追加ボタン -->
                    <div class="add-block-area">
                        <button class="add-block-btn add-block-btn--condition">
                            <span>➕</span>
                            <span>条件グループを追加</span>
                        </button>
                        <button class="add-block-btn add-block-btn--action">
                            <span>➕</span>
                            <span>アクションを追加</span>
                        </button>
                    </div>
                </div>

                <!-- プレビュー -->
                <div class="form__group macro__preview">
                    <label class="form__label">実行内容プレビュー</label>
                    <div class="preview">
                        <div class="preview__title">▶ スキル実行時の動作</div>
                        <pre class="preview__code">
使用条件: 
もし以下の条件を満たすなら
    ([参の型]>=[1]
    または
    [零の型]>=[1])
    かつ
    ([WSコンボ]>=[1])

アクション：
1.アクションを実行
    ([参の型]-[1])
    ([零の型]-[1])
    ([WSコンボ]-[1])
    ([壱の型]+[1])

2. もし以下の条件を満たすなら
    ([参の功力]>=[1])
    
    アクションを実行
    1.選択肢を表示
    [参の功力を消費しますか？]
    -[消費する(+2d6)]
        アクションを実行
        ([参の功力]-[1])
        ([ダメージ]+[+2d6])
    -[消費しない]
</pre>
                    </div>
                </div>
            </div>
            <div class="dialog__footer">
                <button class="form__button--add">アビリティに反映</button>
            </div>
        </div>
        <!-- 外部表示プレビュー -->
        <div class="dialog__preview--macro">

            <div class="dialog__header">
                <div class="section__header--title">実行内容プレビュー</div>
            </div>
            <div class="form__group">

                <div class="preview">
                    <div class="preview__title">▶ スキル実行時の動作</div>
                    <pre class="preview__code">
使用条件: 
もし以下の条件を満たすなら
    ([参の型]>=[1]
    または
    [零の型]>=[1])
    かつ
    ([WSコンボ]>=[1])

アクション：
1.アクションを実行
    ([参の型]-[1])
    ([零の型]-[1])
    ([WSコンボ]-[1])
    ([壱の型]+[1])

2. もし以下の条件を満たすなら
    ([参の功力]>=[1])
    
    アクションを実行
    1.選択肢を表示
    [参の功力を消費しますか？]
    -[消費する(+2d6)]
        アクションを実行
        ([参の功力]-[1])
        ([ダメージ]+[+2d6])
    -[消費しない]
</pre>
                </div>
            </div>
        </div>
    </dialog>
    <div class="context-menu" id="abilityContextMenu" role="menu" aria-hidden="true">
        <button class="context-menu__item" type="button" role="menuitem" data-ability-action="edit">
            再編集
        </button>
        <button class="context-menu__item" type="button" role="menuitem" data-ability-action="duplicate">
            複製
        </button>
        <button class="context-menu__item" type="button" role="menuitem" data-ability-action="delete">
            削除
        </button>
    </div>
    <!--モーダル_バフ登録-->
    <dialog class="dialog--BUFF" id="addBuffModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">バフ・デバフ登録</div>
                <button class="material-symbols-rounded" command="close" commandfor="addBuffModal">close</button>
            </div>
            <div class="dialog__body">
                <div class="form__options">
                    <select class="form__option--type" data-buff-type>
                        <option class="dammy" value="buff" data-buff-type-option="buff">バフ</option>
                        <option class="dammy" value="debuff" data-buff-type-option="debuff">デバフ</option>
                    </select>
                    <button class="form__option--button" command="show-modal"
                        commandfor="BuffLibraryModal">バフ管理</button>
                </div>
                <!--アイコン-->
                <div class="form__group">
                    <span class="form__label">アイコン</span>
                    <div class="form__row">
                        <img id="iconpreview" class="AB__icon" data-buff-icon-preview />
                        <label class="form__option--button">
                            <input type="file" class="form__input--icon" data-buff-icon>
                            <h4>ファイルを選択</h4>
                        </label>
                    </div>
                </div>
                <!--名前-->
                <div class="form__group">
                    <span class="form__label">バフ・デバフ名</span>
                    <input type="text" class="form__input--normal" data-buff-name required>
                    <p class="form__error" data-buff-error="name"></p>
                </div>
                <!--効果説明-->
                <div class="form__group">
                    <span class="form__label">効果説明</span>
                    <input type="text" class="form__input--normal" data-buff-description required>
                    <p class="form__error" data-buff-error="description"></p>
                </div>
                <!--コマンド-->
                <div class="form__group">
                    <span class="form__label">コマンド</span>
                    <input type="number" class="form__input--normal" data-buff-command min="-99" max="99" step="1">
                    <p class="form__error" data-buff-error="command"></p>
                </div>
                <!--追加テキスト-->
                <div class="form__group">
                    <span class="form__label">追加テキスト</span>
                    <input type="number" class="form__input--normal" data-buff-extra-text min="-99" max="99" step="1">
                    <p class="form__error" data-buff-error="extraText"></p>
                </div>
                <!--対象-->
                <div class="form__group">
                    <span class="form__label">対象</span>
                    <select class="form__option--type" data-buff-target>
                        <option class="dammy" value="" data-buff-target-option="none">---</option>
                        <option class="dammy" value="judge" data-buff-target-option="judge">判定</option>
                        <option class="dammy" value="damage" data-buff-target-option="damage">ダメージ</option>
                    </select>
                </div>
                <!--継続時間-->
                <div class="form__group">
                    <span class="form__label">継続時間</span>
                    <select class="form__option--type" data-buff-duration>
                        <option class="dammy" value="permanent" data-buff-duration-option="permanent">永続</option>
                        <option class="dammy" value="until-turn-end" data-buff-duration-option="until-turn-end">ターン終了まで</option>
                        <option class="dammy" value="until-next-turn-start" data-buff-duration-option="until-next-turn-start">次のターン開始まで</option>
                    </select>
                </div>

                <!--一括登録-->
                <div class="form__group">
                    <span class="form__label">一括登録</span>
                    <textarea class="form__input--description" data-buff-bulk></textarea>
                </div>
                <p class="form__error-summary" data-buff-error-summary aria-live="polite"></p>
            </div>
            <div class="dialog__footer">
                <button class="dialog__footer__button form__button--add" data-buff-submit>登録</button>
            </div>
        </div>
    </dialog>

    <!--バフ表-->
    <dialog class="dialog--BUFF-library" id="BuffLibraryModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">バフ・デバフ管理</div>
                <button class="material-symbols-rounded" command="close" commandfor="BuffLibraryModal">close</button>
            </div>
            <div class="dialog__body">
                <div class="form__options">
                    <button class="form__option--button" data-buff-library-add>新規バフ登録</button>
                </div>

                <table border="1" data-buff-library>
                    <thead>
                        <tr>
                            <th></th>
                            <th>アイコン</th>
                            <th>名前</th>
                            <th>編集</th>
                        </tr>
                    </thead>
                    <tbody data-buff-library-body>
                        <tr data-buff-library-row data-buff-library-mock hidden>
                            <td>
                                <button class="material-symbols-rounded" data-buff-library-delete>delete</button>
                            </td>
                            <td>
                                <img src="assets/dummy_icon-buff.png" alt="buff icon" />
                            </td>
                            <td>バフ名</td>
                            <td>
                                <button class="material-symbols-rounded" data-buff-library-edit>edit</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </dialog>

    <!--モーダル_特性リソース登録・管理-->
    <dialog class="dialog--TRAIT" id="addTRAITModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">特性・リソース管理</div>
                <button class="material-symbols-rounded" command="close" commandfor="addTRAITModal">close</button>
            </div>
            <div class="dialog__body">
                <div class="resource__group resource__preview">
                    <span class="resource__label">登録済みリソース：リソース名</span>
                    <div class="resource--stack">
                        <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                        <img class="resource__icon--arrow" src="assets/resource--stack.png" />
                    </div>
                </div>
                <div class="resource__group resource__preview">
                    <span class="resource__label">登録済みリソース：リソース名</span>
                    <div class="resource--gauge">
                        <img class="resource__icon--gauge" src="assets/resource--gauge.png" />
                        <span class="resource__icon--gauge-value">2</span>
                    </div>
                    <div class="resource__options">

                        <div class="form__row">
                            <!--名前-->
                            <div class="form__group">
                                <span class="form__label">リソース名</span>
                                <input type="text" class="form__input--normal">
                            </div>
                            <!--現在値-->
                            <div class="form__group">
                                <span class="form__label">現在値</span>
                                <input type="number" class="form__input--normal">
                            </div>
                            <!--最大値-->
                            <div class="form__group">
                                <span class="form__label">最大値</span>
                                <input type="number" class="form__input--normal">
                            </div>
                        </div>
                        <div class="form__group">
                            <span class="form__label">形状</span>
                            <div class="form__row">
                                <select class="form__option--type">
                                    <option class="dammy">ゲージ</option>
                                    <option class="dammy">スタック（▷）</option>
                                    <option class="dammy">スタック（○）</option>
                                    <option class="dammy">スタック（□）</option>
                                </select>
                                <select class="form__option--color">
                                    <option class="dammy">red</option>
                                    <option class="dammy">blue</option>
                                    <option class="dammy">yellow</option>
                                    <option class="dammy">green</option>
                                    <option class="dammy">purple</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <!--登録ボタン-->
                <button>リソースを追加する</button>
            </div>
        </div>
    </dialog>

    <!--モーダル_キャラクター設定-->
    <dialog class="dialog--Chara" id="characterSettingModal" closedby="any">
        <div class="dialog__main">
            <div class="dialog__header">
                <div class="section__header--title">キャラクター設定</div>
                <button class="material-symbols-rounded" command="close"
                    commandfor="characterSettingModal">close</button>
            </div>
            <div class="dialog__body">
                <div class="form__group">
                    <span class="form__label">操作モード</span>
                    <div class="form__row">
                        <label class="form__option--button">
                            <input type="radio" name="mode-select" value="simple" checked>
                            <h4>シンプル</h4>
                        </label>
                        <label class="form__option--button">
                            <input type="radio" name="mode-select" value="custom">
                            <h4>カスタム</h4>
                        </label>
                    </div>
                </div>
                <div class="form__row">
                    <!--ジョブ-->
                    <div class="form__group">
                        <span class="form__label">ジョブ名及びレベル</span>
                        <input type="text" class="form__input--normal">
                    </div>
                    <!--使用ステータス-->
                    <div class="form__group">
                        <span class="form__label">使用ステータス</span>
                        <select class="form__option--type">
                            <option class="dammy">STR</option>
                            <option class="dammy">DEX</option>
                            <option class="dammy">INT</option>
                            <option class="dammy">MND</option>
                        </select>
                    </div>
                </div>
                <button class="dialog__footer__button form__button--add">更新</button>
                <h3>データ管理</h3>
                <div class="form__group">
                    <label class="form__label">クリップボードから貼り付けて読み込み:</label>
                    <textarea id="importText" placeholder='.txtまたは.jsonファイルを直接ドロップしても読み込めます'></textarea>
                </div>
                <div class="form__row">
                    <button id="importConfirm">
                        <span class="material-symbols-rounded">download</span>
                        <span>このデータを読み込み</span>
                    </button>
                    <button id="exportToClipboard">
                        <span class="material-symbols-rounded">content_copy</span>
                        <span>現在の設定をクリップボードにコピー</span>
                    </button>
                </div>
                <button id="resetBtn">
                    <span class="material-symbols-rounded">delete_forever</span>
                    <span>すべて初期化</span>
                </button>

            </div>
        </div>
    </dialog>

</main>
<div class="toast-container" data-toast-container></div>
<script src="scripts/toast.js"></script>
<script src="scripts/ability.js"></script>
<script src="scripts/ability-preview.js"></script>
<script src="scripts/buff.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const abilityModal = document.getElementById("addAbilityModal");
        if (!abilityModal) {
            return;
        }

        const abilityTypeSelect = abilityModal.querySelector("[data-ability-type]");
        const targetAreaButtons = document.querySelectorAll(
            'button[command="show-modal"][commandfor="addAbilityModal"][data-target-area]'
        );
        const typeToAreaMap = {
            main: "main",
            sub: "sub",
            instant: "instant",
            other: "other",
        };
        const areaToTypeMap = Object.fromEntries(
            Object.entries(typeToAreaMap).map(([type, area]) => [area, type])
        );

        const resolveTargetAreaByType = (typeValue) =>
            typeToAreaMap[typeValue] ?? typeToAreaMap.main;

        const setModalTargetArea = (targetArea) => {
            if (!targetArea) {
                return;
            }
            abilityModal.dataset.targetArea = targetArea;
        };

        const syncTypeWithTargetArea = (targetArea) => {
            if (!abilityTypeSelect) {
                return;
            }
            const typeValue = areaToTypeMap[targetArea];
            if (typeValue) {
                abilityTypeSelect.value = typeValue;
            }
        };

        targetAreaButtons.forEach((button) => {
            button.addEventListener("click", () => {
                const targetArea = button.dataset.targetArea;
                if (!targetArea) {
                    return;
                }
                setModalTargetArea(targetArea);
                syncTypeWithTargetArea(targetArea);
            });
        });

        if (abilityTypeSelect) {
            abilityTypeSelect.addEventListener("change", (event) => {
                const selectedType = event.target.value;
                const targetArea = resolveTargetAreaByType(selectedType);
                setModalTargetArea(targetArea);
            });
        }
    });
</script>
</body>

</html>
